---
title: "Evolutionary simulations of \\textit{Z}-linked suppression gene drives"
author:
- Luke Holman*
- '*\textit{luke.holman@unimelb.edu.au} \vspace{5mm}'
bibliography: references.bib
output:
  pdf_document:
    fig_caption: yes
    includes:
      in_header: latex_header.tex
  html_document: default
  word_document: default
fontsize: 12pt
csl: phil-trans.csl
abstract: \noindent Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
source("../code/table_1_code.r")

model_runs <- "6,000,000"
```

\maketitle\unmarkedfntext{*School of BioSciences, The University of Melbourne, Victoria, Australia.}

\textbf{Keywords: \textit{W}- and \textit{X}-shredders, Lepidopteran pests, meiotic drive, population control, schistosomiasis, selfish genes}.

<!-- \usepackage[all]{hypcap} -->

<!-- Here is a reference [e.g. @Holman_2018], and here's a link to a figure (\autoref{example_plot}). -->


\newpage
# Introduction

Developments in biotechnology will soon make it feasible to alter or eliminate populations of disease vectors, pathogens, agricultural pests, and invasive species using 'gene drives' [@gantz2015hi; @hammond2016cr; @wang2016cr; @prowse2017do; @kyrou2018cr; @noble2018cu]. Gene drives cause particular alleles (usually transgenes) to propagate through populations via a range of mechanisms including gene conversion, poison-antidote systems, segregation distortion, and genetic incompatibility [@lindholm2016ec; @champer2016ch]. For example, CRISPR-Cas9 gene editing can be used to create a transgenic insertion that is transmitted to almost 100% of the offspring of heterozygous individuals instead of the usual 50%; this type of gene drive functions by inducing a double-strand break in the wild type allele, which is then repaired using the transgene as a template. Gene drives are often categorised into two types, both of which can be created with homing endonucleases like CRISPR-Cas9. 'Replacement drives' aim to propagate a human-beneficial allele that would not otherwise spread through the population, e.g. a mosquito allele that interferes with the tranmission of malaria [@gantz2015hi; @marshall2015gene]. Conversely, 'suppression drives' aim to cause extinction (or at least a reduction in population size), for example by propagating an allele that causes lethality or sterility (MORE HERE [@hammond2016cr; @kyrou2018cr]), or which skews the offspring sex ratio -- typically towards males MORE HERE [@beaghton2017ve; @burt2018se; @papathanos2018re].

Recent theoretical papers have investigated the feasibility, efficacy, and potential negative consequencies of emerging gene drive technologies. For example, Noble et al. [-@noble2018cu] used models to show that the basic version of a CRISPR gene drive might be highly invasive and could rapidly spread to fixation across whole meta-populations and species, which will sometimes be undesirable. Conversely, other models have concluded that alleles conferring resistance to the gene drive can prevent it from spreading and  acheiving its aims [@drury2017cr; @unckless2017ev]. The issue of resistance is compounded because the standard implementation of CRISPR-Cas9 gene drive (but perhaps not updated versions; [@esvelt2014em; @unckless2017ev; @prowse2017do; @kyrou2018cr]) tends to create its own resistance alleles, e.g. when the double-stranded break induced by Cas9 is repaired using non-homologous end joining (NHEJ) instead of homology-directed repair [@gantz2015mu; @gantz2015hi; @hammond2016cr; @wang2016cr; @unckless2017ev]. Given the potential safety, ethical, and sociopolitical concerns surrounding gene drives, some models have focused on gene drives that would go extinct after a time [@min2017da; @burt2018se; noble2019da], would stay confined to particular populations [@maselko2018ge; @noble2019da], and/or could be reversed once they have spread [@vella2017ev]. 

Here, I focus on the evolutionary dynamics of _Z_-linked suppression gene drives. The simulation is inspired by proposals for various types of _Z_-linked gene drives by Kevin Esvelt and colleagues, as well as their ongoing efforts to develop these _Z_ drives (see [www.sculptingevolution.org/genedrives/current/schistosomiasis](); at the time of writing, these ideas have not been published in a journal or pre-print). Various _Z_-linked suppression drives proposed by Esvelt and colleagues are shown schematically in Figure XX. The gene drive would enjoy a transmission advantage in _ZW_ females, and optionally also in _ZZ_ males. Esvelt et al. propose that _Z_-linked drives could be used to control the trematode parasites (_Schistosoma_ spp.) responsible for the deadly disease schistosomiasis, though _Z_-linked drives could theoretically be used to control any organism with female-heterogametic sex determination, such as Lepidopteran crop pests or even invasive populations of birds.

A _Z_-linked gene drive could suppress populations by biasing gametogenesis in females, for example by inducing double-stranded DNA breaks in the _W_ chromosome in order to destroy it; such a gene drive would be a '_W_-shredder', similar to the _X_- and _Y_-shredders under development for _XY_ species [@windbichler2008ta; @north2013mo; @galizi2014sy; @burt2018se; @papathanos2018re; @prowse2019]. Females carrying the gene drive would thus produce relatively few viable _W_-bearing eggs, and therefore produce mainly drive-carrying sons. Esvelt et al. point out that the evolutionary dynamics of the drive will depend on the fitness of drive carriers relative to wild types, the timing of _W_-shredding (e.g. in pre-meiotic cells vs mature ova or zygotes), and the ecology of the target species. For example, some _W_-shredder designs might allow drive females to produce roughly the same number of (mostly-male) offspring as a wild-type female provided that the _W_ chromosome is destroyed early enough in oogenesis/development that the lost daughters can be replaced by sons (Figure XX). Alternatively, drive-carrying females might produce half the number of offspring (or less), e.g. if the drive works by destroying all ova or offspring that carry a _W_ chromosome, and this loss is not compensated by reduced competition on the surviving offspring. As an alternative to _W_-shredders, Esvelt et al. also proposed that one could suppress populations using a _Z_-linked locus that caused sterility or lethality in females. If this female-harming allele were capable of gene drive in males (see below), it could perhaps reach high enough frequencies to suppress the population. Esvelt et al. suggest that a _W_-shredder would also benefit from undergoing gene drive in males, though they suggest it might not be necessary. Male gene drive could be accomplished using 'standard' CRISPR-Cas9 gene conversion (REF), whereby the driving _Z_ allele would convert the wild type locus using homing endonuclease activity followed by DNA repair, causing heterozygous males to produce mostly drive-carrying sperm and offspring. 

Here, I present an evolutionary simulation that can accommodate all of these hypothesised types of _Z_-linked drives. I aimed to test which properties of the gene drive and the ecology of the target species are critical to determining the likelihood and speed with which the gene drive causes extinction. For example, the gene drive will presumably spread faster if it can bias transmission in both sexes, but perhaps a female-only gene drive (which might be easier to engineer) would be perfectly adequate. Also, since the population will become more male-biased as the gene drive invades, there will be eco-evo feedback (REF) that might affect the evolutionary outcome in non-intuitive ways that would be missed without a formal model. For example, the altered sex ratio might intensify the fitness advantage accruing to any resistant _W_ chromosomes or autosomal modifiers that prevent _W_-shredding (due to Fisherian selection for an even sex ratio; [@holman2015co]), relative to that observed in earlier models focusing on gene drives carried on autosomes [@unckless2017ev; @drury2017cr]. Moreover, the change in sex ratio could affect the demographics of the population, particularly if males and females contribute differentially to density-dependent population growth [@rankin2007ma; @li2019int], or have different dispersal rates [@li2019sex]. The model incorporates the possibility that _Z_-linked resistant-to-drive alleles are sometimes created by NHEJ in heterozygote males, and tests whether these alleles are equally problematic as for autosomal drives [@gantz2015mu; @gantz2015hi; hammond2016cr; wang2016cr; @unckless2017ev].


# Methods

## Overview

I model a finite population of dioecious diploids with _ZW_ sex determination, living in $j$ discrete habitat patches that are arranged linearly in a ring. The model considers the demography and evolution of a population into which $n_{release}$ males carrying a _Z_-linked gene drive are released. The drive allele causes either _W_-shredding or sterility in females, and optionally also causes gene drive in heterozygous males (e.g. via gene conversion of the non-driving _Z_). The generations are non-overlapping and each one proceeds as follows: birth, dispersal between patches, breeding with patches, and death of the parental generation. The species has 3 loci with 2-3 alleles each, some of which potentially show non-Mendelian inheritance. The equilibrium population size was roughly 10,000 in all simulations upon release of the gene drive. The model is a stochastic individual-based simulation written in R 3.4.0 and was run on the `Spartan` computer cluster at the University of Melbourne. An accompanying website describes the R scripts used to run, analyse and plot the model (URL HERE). 

## Loci and alleles

Each male in the simulation carries one _Z_-linked locus and two autosomal loci, each with two alleles. Each female carries a single allele at the _Z_-linked locus plus a _W_ chromosome, as well as two alleles at both of the autosomal loci.

There are three possible _Z_-linked alleles: a gene drive allele (denoted _Z\*_), a wild-type allele (_Z+_) that is vulnerable to gene drive in _Z\*Z+_ males, and a resistant allele (_Z^r_) that is immune to gene drive in _Z\*Z^r_ males. Similarly, there are two possible types of _W_ chromosomes: a wild-type _W_ chromosome (_W+_) that is vulnerable to gene drive by the _Z\*_ allele, and a resistant _W_ chromosome (_Wr_) that is immune to gene drive.

The two autosomal loci, denoted _A/a_ and _B/b_, control immunity to _W_-shredding and gene conversion respectively. _A/a_ and _B/b_ are 'trans-acting' resistance loci, since they are at a different locus (indeed, a different chromosome) to the gene drive allele, in contrast to the 'cis-acting' resistance conferred by the _Z^r_ and _Wr_ alleles. The _A_ allele is dominant to _a_ and confers immunity to _Z_-linked gene drive (e.g. _W_-shredding) in females. The _B_ allele is dominant to _b_ and confers immunity to _Z_-linked gene drive (e.g. gene conversion) in males. 


## Calculating female and male fitness

I assume that wild-type individuals (i.e. those lacking drive or resistance alleles) have fitness $w$ = 1, while other genotypes have $0 \le w \le 1$. The fecundity of females carrying the gene drive is reduced by a factor $1 - c_f$. Small $c_f$ implies minimal costs (e.g. because lost gametes/offspring are easily replaced), $c_f = 0.5$ could represent the case where all daughters die and are not replaced, and $c_f = 1$ means that females carrying _Z\*_ are completely sterile (setting $c_f = 1$ allows us to model a female-sterilising _Z_-linked drive rather than a _W_-shredder). Similarly, the fitness of males carrying the gene drive is reduced by a factor $1 - c_m$; male fitness determines mating success (see below). Furthermore, the resistant chromosomes _Wr_ and _Z^r_ are assumed to reduce fitness by factors of $1 - c_w$ and $1 - c_z$ respectively. For brevity, I assume that the autosomal resistance alleles _A_ and _B_ are cost-free. All costs are multiplicative; for example, a _Z\*Z^r_ male would have fitness $(1 - c_m)(1 - c_z)$. Additionally, all costs are assumed to be dominant, meaning that having one drive or resistance allele is equally costly as having two (note that this is only relevant in males because of female heterogamety).


## Gamete production and gene drive

I assume that the _A/a_ and _B/b_ loci segregate independently during meiosis and display standard Mendelian inheritance. Inheritance of the sex chromosomes is also Mendelian, except for certain genotypes carrying one _Z\*_ allele. 

Firstly, _Z\*W+aaBB_, _Z\*W+aaBb_, and _Z\*W+aabb_ females produce a fraction $\frac{1}{2}(1 + p_{shred})$ of _Z_-bearing gametes and $\frac{1}{2}(1 - p_{shred})$ _W_-bearing gametes. Therefore, these three female genotypes produce >50% sons when $p_{shred} > 0$, due to the shortage of _W_ chromosomes in their gametes. Note that the gamete frequencies of _Z\*Wr females_, or of females carrying at least one _A_ allele, conform to the standard Mendelian expectations due to resistance.

Secondly, _Z\*Z+AAbb_, _Z\*Z+Aabb_, and _Z\*Z+aabb_ males produce a fraction $\frac{1}{2}(1 + p_{conv} - p_{conv} p_{nhej})$ of gametes carrying the _Z\*_ allele, $\frac{1}{2}(1 - p_{conv})$ gametes carrying the _Z+_ allele, and $\frac{1}{2}(p_{conv} p_{nhej}))$ gametes carrying the _Z^r_ allele. Thus, gene conversion occurs in males if $p_{conv} > 0$, meaning that the _Z\*_ allele is over-represented in the gametes of these three male genotypes. The parameter $p_{nhej}$ represents non-homologous end joining, in which an endonuclease-based gene drive fails to copy itself to the homologous chromosome, and instead deletes its target site and thereby creates a resistant allele. The gamete frequencies of _Z\*Z^r_ males, or of males carrying at least one _B_ allele, conform to the standard Mendelian expectations due to resistance.


## Calculating female fecundity
In the breeding phase of the lifecycle, the model first determines the number of offspring produced by each female. The expected fecundity of female $i$ ($F_i$) is affected by three factors: the female's genotype, the density of males and females in the local patch and/or in the full population, and some global parameters in the model, as follows:

$$F_i = (1 + w_i r(1 - (D_i / K) ^ \alpha))$$

where $D_i$ is the 'density' experienced by female $i$, $w_i$ is her fitness ($0 \le w_i \le 1$), $K$ is the carrying capacity, and $r$ and $\alpha$ are constants that control the maximum possible fecundity and the shape of density-dependence, respectively [function inspired by @fowler1981de].

To ensure that the simulation captures various possible types of life history and ecology, I calculated density $D_i$ in various ways in different simulation runs. First, I define the 'global density' $d_g$, which acts equally on every female in every patch, as 

$$d_g = \sum_{i=1}^{N_f} w_i + \delta N_m$$	

where $N_f$ and $N_m$ are the numbers of females and males across all patches, the first term is the summed fitnesses of all these females, and $\delta$ is a constant (range: $0-\infty$) that scales the effect of each male on $d_g$ relative to a female with fitness $w_i = 1$. This formulation means that females with high relative fitness (i.e. fecundity) have a stronger effect on the global density than do low-fitness females. I also assume that each male contributes a fixed amount to the global density, irrespective of his genotype/fitness (since I assume that male fitness only affects male mating success; see below). The parameter $\delta$ represents sex differences in ecological niche use and behaviour. For example, we might expect $\delta<1$ in species where males and females utilise very different environmental niches, or $\delta>1$ in species where males are harmful to females.

Second, we define the 'local density' $d_j$, which is experienced by every female in patch $j$, as 

$$d_j = \sum_{i=1}^{n_{f,j}} w_i + \delta n_{m,j}$$	

where $n_{f,j}$ and $n_{m,j}$ are the numbers of females and males in patch $j$. As before, this formulation means that $d_j$ depends on the fitnesses of the females in the patch, as well as the number of males (scaled by the constant $\delta$).

Finally, the overall density experienced by female $i$ in patch $j$ ($D_i$) is a composite of the global and local densities given by $D_i = \psi d_g + (1 - \psi)d_j$. The parameter $\psi$ scales the importance of global and local density to female fecundity. When $\psi = 0$, only local density matters and selection on females is entirely "soft", while when $\psi = 1$ only global density matters and selection on females is completely "hard" (REFERENCE). Intermediate values of $\psi$ produce a mixture of hard and soft selection on females, and the  pgrowth rate of population depends on density at both scales.

After calculating the expected fecundity of each female ($F_i$), we generate the realised fecundity of the female by randomly sampling from a Poisson distribution with $\lambda = F_i$ (allowing for stochastic variation in fecundity between females with equal $F_i$). If the resulting number of offspring exceeded the global carrying capacity $K$, the model randomly selects $K$ surviving offspring. 


## Competition between males

After determining how many offspring each female produces, we determine the fathers of each of these offspring. We assume that all breeding occurs within patches, such that males only compete for matings/fertilisations with males in the same patch. If the patch contains $k$ different male genotypes and there are $n_1, n_2, ... n_k$ males of each genotype, the probability that a male of genotype $k$ is the father of any given offspring is 

$$p_j = \frac{n_{k}w_k}{\sum_{i=1}^{k}n_{i}w_i}$$

such that relatively common and/or high-fitness male genotypes are more likely to sire offspring. This formulation means that both sexes potentially reproduce with multiple partners.

## Reproduction, mutation and dispersal

After picking the parents, the model randomly generates each offspring's genotype based on the expected gamete (and thus zygote) frequencies. Offspring are born in the same patch as their parents, and the parental generation is replaced by the offspring generation.

When an offspring is created, each _Z+_ allele it carries has a chance $\mu_Z$ to mutate to a _Z^r_ allele, and _vice versa_ (i.e. mutation in both directions is equally probable). Similarly, each _W+_ allele has a chance $\mu_W$ to mutate to a _Wr_ allele, and _vice versa_. 

Female and male offspring disperse to another patch with probabilities $x_f$ and $x_m$ respectively. We model two types of dispersal, in separate simulations: local dispersal, in which offspring move to one of the two neighbouring patches with equal probability (recalling that the patches are arranged in a ring), or global dispersal, in which dispersing offspring can land in any of the other patches.

## One compete run of the simulation

The model first initialises a population of 10,000 individuals (the carrying capacity, $K$) with low or zero frequencies of _Z^r_, _Wr_, _A_ and _B_ alleles, higher frequencies of the wild type _Z+_, _W+_, _a_, and _b_ alleles, and zero _Z\*_ gene drive alleles. It then runs 50 generations of burn-in to allow the population to reach demographic and genotypic equilibrium. Next, $n_{release}$ males with the genotype _Z\*Z\*aabb_ are added to the population just before fathers are selected, representing the release into the wild of a laboratory-reared strain homozygous for the driving _Z_. In some simulations, all the _Z\*Z\*aabb_ males were released in a single patch, while in others the $n_{release}$ males were randomly and evenly divided across all $k$ patches. The model continued until either A) the driving _Z\*_ allele went extinct, B) the population went extinct, C) the _Wr_ chromosome went to fixation (making population suppression impossible), D) the _Z\*_ allele fixed, but failed to cause population extinction, or E) 900 generations had elapsed. The model recorded which of these five outcomes occurred, as well as the allele frequencies, population size, and sex ratio at each generation. 

## Investigating the parameter space
For each of the parameters in Table 1, I selected two or more possible parameter values (e.g. high versus low rates of _W_-shredding $p_{shred}$; many versus few patches $k$). I then ran the model once for all possible combinations of these parameter values (n = `r model_runs` model runs). The aim was to measure the effect of each parameter across a background of assumptions for the other parameters, as well as to investigate all possible 2-way interactions between the parameters.


# Results

## Three illustrative simulation runs
Figure 1 shows three contrasting evolutionary outcomes, illustrating some representative evolutionary dynamics from among the `r model_runs` simulation runs. Tables S1-S2 give the relative frequencies of the various possible outcomes (e.g. extinction occurred in 28% of simulations involving _W_-shredders).

In Figure 1A, the release of 20 _Z\*Z\*_ males at generation 50 ($c$. 0.2% of the population) was followed by the rapid invasion of the _Z\*_ allele, which caused population extinction by reducing the number of females. Figure 1A assumes that the _Z\*_ alleles causes perfect _W_-shredding ($p_{shred} = 1$), that _Z\*_ has minimal fitness costs, and there is no resistance to _W_-shredding (Table S3). 

In Figure 1B, _Z\*_ invaded but failed to cause extinction, even though it was assumed that $p_{shred} = 1$ and there is no resistance to _W_-shredding. However, the simulation in Figure 1B assumed the presence of heavy fitness costs to individuals carrying at least one _Z\*_ allele ($c_f = 0.5$ and $c_m = 0.2$), and that there was no gene drive in males ($p_{conv} = 0$). The assumptions $p_{shred} = 1$ and $c_f = 0.5$ could imply that the _W_-bearing eggs/offspring of _Z\*W+_ females are destroyed but not replaced, such that _W_-shredding increases the proportion but not the absolute number of offspring that inherit the _Z\*_ allele. Essentially _Z\*_ spreads via 'spite' [REF], in that it removes _W_ chromosomes from the local population and thereby makes room for more _Z\*_ alleles, creating indirect fitness benefits. However, the net fitness returns of the _Z\*_ allele's 'strategy' (i.e. sacrificing 20% fitness in males in order to remove _W_ chromosomes in females) decline as the _W_ chromosome becomes rarer, allowing the cost in males to greatly slow the spread of _Z\*_.

Lastly, Figure 1C shows a case where the invasion of _Z\*_ was halted and then reversed by the evolution of autosomal and _Z_-linked resistance alleles. Following the introduction of the _Z\*_ allele, resistant _Z^r_ mutants were created via non-homologous end joining, and then _Z^r_ spread to fixation due to its immunity to gene conversion in males. The autosomal resistance allele _A_ also spread; _A_ confers resistance to _W_-shredding and was initially present in the population at 5% frequency. The spread of _A_ caused the sex ratio to revert to normal, preventing extinction, and _Z\*_ went extinct due to its direct fitness costs no longer being outweighed by the benefits of _W_-shredding and gene conversion. Incidentally, the resistant allele _A_ was favoured over _a_ because the male-biased population sex ratio created by _Z\*_ favours the production of daughters, and _AA_ and _Aa_ females produce more daughters than _aa_ females in populations where _Z\*_ is present.


## Effects of each parameter on the evolution of a _W_-shredder
Figure 2 shows the main effects of each model parameter, for models of a _Z_-linked _W_-shredder that potentially also benefits from gene drive in _Z\*Z_ males. Figure S1 is similar to Figure 2, but instead shows the number of generations until extinction on the $y$-axis. Under favourable assumptions, extinction occurred around 20 generations after introduction of the gene drive, though if was often longer (Figure S1).

In Figure 2, the parameters are arranged in approximate order of their importance to extinction probability. By far the most important predictors of extinction were the efficiency of _W_-shredding in females ($p_{shred}$) and the existence of resistance against _W_-shredding: extinction never occurred unless $p_{shred}$ was high and autosomal alleles conferring resistance to _W_-shredding (allele _A_ in the model) were absent. This makes sense, because a _W_-shredder cannot cause extinction unless _Z\*_-carrying females produce a strongly male-biased sex ratio, and resistance to _W_-shredding cannot readily evolve. Extinction also occurred a little more quickly when $p_{shred}$ was 1 rather than 0.95 (Figure S1).

The strength of gene drive in _Z\*Z_ males ($p_{conv}$; colours in Figure 2) also predicted extinction probability. However, $p_{conv}$ was not as important as was the strength of _W_-shredding, and the _W_-shredder frequently caused extinction even if it did not drive in males, or if resistance to male gene drive was common. The benefit to extinction probability provided by male gene drive depended on other factors in the model (see plots of interactions; Figures XX); for example, male gene drive was at its most beneficial when resistance to it could not evolve (either through natural genetic variation, or the creation of resistant _Z^r_ alleles through NHEJ). Although it did not strongly determine the probability of extinction probability, male gene drive did considerably speed up extinction (Figure S1). For example, assuming perfect _W_-shredding, adding male gene drive with $p_{conv} = 0.95$ reduced the expected time to extinction from around 75 to 22 generations. 

The cost of the _Z\*_ allele to female fitness also affected extinction probability, and its effect interacted with the strength of gene drive in _Z\*Z_ males. Specifically, assuming that the _Z\*_ allele halves female fitness ($c_f = 0.5$) cancels out the fitness benefits of segregation distortion for the _Z\*_ allele, and so extinction could only occur when $c_f = 0.5$ if there was gene drive in males. Reassuringly, increasing $c_f$ from 0.01 or 0.1 had almost no effect on the likelihood of extinction, meaning that _W_ shredders might be an effective means of population control even if females carrying the gene drive suffer a 10% fitness cost. Similarly, assuming that _Z\*_ was costly to male carriers also had little effect on extinction probability: extinction occurred almost as frequently when the reduction in male mating success was 20% rather than 1%. Both $c_f$ and $c_m$ were positively correlated with the time to extinction, particularly when there was no gene drive in males (Figure S1).

Several of the ecological variables examined also affected the extinction probability. Chief among these was the shape parameter, $\alpha$, of the density-dependence function. $\alpha < 1$ means that female fecundity declines at a decelerating rate as density increases, such that per-female fecundity only approaches its maximum value when the population is heavily depleted, making extinction more likely. Conversely for $\alpha > 1$, fecundity declines at an accelerating rate with increasing density, making extinction less likely due to the immediate increases in per-female fecundity that manifest once the population begins to shrink due to the spread of the gene drive. Unsurprisngly, I also found that populations in which females have a higher maximum possible fecundity ($r$) are somewhat more difficult to drive extinct, though the model confirmed that _W_-shredders can, in principle, drive extinct highly fecund species. Also, extinction was slightly more probable when female fecundity was determined more by local density than global density ($\psi$ in Figure 2). This is because local density can remain high (and thus, per-female fecundity can remain low) even in meta-populations that are declining due to the spread of the _Z\*_ allele in some of their sub-populations.

Extinction probability also increased with $\delta$, the parameter that determines how male density affects female fecundity. When $\delta$ is high, female fecundity is constrained from increasing as the drive allele spreads by the ever-increasing proportion of males, contributing to extinction. Conversely, lower values of $\delta$ mean that male numbers are relatively unimportant in determining female fecundity, making extinction less likely because the shortage of females created by the gene drive alleviates competition on the remaining females. This result highlights that it is important to consider the ecology and population dynamics of target species when designing gene drives that work by eliminating one sex.

Populations that are split into many semi-isolated patches were more difficult to drive extinct that those that comparatively free of spatial structure, though the effect on extinction rate was small (Figure 2). The likely reason is that a highly-structured population allows for refugia that lack the gene drive allele. The frequency and sex bias in dispersal was relatively unimportant to extinction probability, though there was a slight tendency for higher dispersal rates to stave off extinction, presumably because dispersal allows recolonisation of patches that were cleared by the gene drive. Similarly, it did not matter whether dispersal carried individuals to any patch, or only to neighbouring patches. Finally, there was no effect of the release strategy, suggesting that it may be unnecessary to release a _W_-shredding gene drive across the species' entire range provided that there is gene flow between patches. An additional implication of this result is that we cannot expect _Z_-linked gene drives to remain confined to their release sites, as previously found for autosomal drives [@noble2018cu].


## Effects of each parameter on a female-sterilising _Z_ drive
I also used the model to examine the evolution of a _Z_-linked allele that causes gene drive in males and also causes total sterility in females ($c_f = 1$; Figure S2). This alternative type of gene drive was also effective at causing extinction, but only under the assumption that the population has little or no resistance to gene drive in males. For example, extinction never occurred if even 1% of the progeny of _Z\*Z_ males inherited a resistant _Z^r_ allele created by non-homologous end joining [c.f. @unckless2017ev]. Extinction also required that gene drive in males was strong (high $p_{conv}$), and that there were no autosomal resistance alleles to male gene drive. The effects of the other parameters in the model were similar as for a _W_-shredder (Figure S2), and extinction (when it occurred) took a fairly similar number of generations (around 25-30; Figure S3).


# Discussion

The model indicates that _W_-shredders are, in principle, a very effective method for eliminating populations, especially if _W_-shredding is highly efficient and resistance to it cannot readily evolve. The results of the model have implications for the design and effects of _Z_-linked _W_-shredders and female-sterilising suppression drives.

One design consideration is whether to engineer _W_-shredders that are also capable of gene drive in males, e.g. by including CRISPR/Cas9 guide RNAs that target the _Z_ as well as the _W_ chromosome in the gene drive cassette. In the model, _W_-shredders very often caused extinction even without male gene drive (i.e. when $p_{conv} = 0$), provided that females carrying the _W_-shredder had comparable fecundity to wild type females, and that carrier females produce very few daughters. Conversely if _W_-shredder females had low fecundity (around half that of a wild type, or below) or produced some daughters, male gene drive was essential for the _W_-shredder to cause extinction, or at least for extinction to occur quickly enough to be useful. Although male gene drive was not always essential to extinction, it did reduce the number of generations until extinction occurred, sometimes substantially. Therefore, I conclude that it would almost certainly be worth the effort to incorporate a male-acting gene drive if developing a _W_-shredder for species with long generation times, such as invasive birds. However the rate of population decline may be adequate even without male gene drive for species that have multiple generations per year, such as Lepidopteran pests and _Schistosoma_ parasites. This could simplify the design of _W_-shredders since they would only need to target the _W_, particularly because male-acting CRISPR-based drives are more challenging to develop in at least some taxa [due to sex differences in DNA repair; @grunwald2019super]. 

Another aim when designing _W_-shredders should be to ensure that female carriers produce as few daughters as possible (ideally none), while producing a large number of drive-carrying sons (ideally as many as the total offspring produced by non-carriers). This implies that one should ideally design a construct that cleaves the _W_ chromosome early in gametogenesis or development, to increase the chance that the number of surviving progeny produced by each female is unaffected. For some species, this may mean placing the _W_-shredder under the control of a promoter that is active in the female germ line [perhaps _nanos_; @zhang2018si], such that females are able to replace lost _W_-bearing oocytes before they are provisioned with limiting maternal resources. For other species, it may be possible to shred the _W_ chromosome in _W_-bearing ova or embryos using maternally-derived Cas9 and guide RNAs deposited in the egg after being synthesised by the _Z\*_ allele [somewhat like _Medea_; @hay2010en]. In Lepidoptera, juvenile density is often strongly negatively correlated with survival, and there are maternally-transmitted endosymbionts that are able to drive through populations by killing males to lessen competition on their infected sisters [e.g. @jiggins2000bu; @jiggins2003ma]; these observations suggest that _W_-shredder alleles would invade Lepidopteran populations even if _Z\*W_ females produced half as many eggs. Unsurprisngly, models of a female-sterilising _Z_-linked element showed that the element could only spread and cause extinction if it benefitted from gene drive in males. These female-sterilising drives were effective at causing extinction, but were very vulnerable to the evolution of resistance to gene drive in males [e.g. if drive-resistant alleles are created by NHEJ; @unckless2017ev]. 

The _W_-shredding mechanism should also be designed in a way that makes it difficult for _W_-linked or _trans_-acting resistance to shredding to evolve. One way to do this would be to use a single guide RNA that targets _W_-specific sequences that have high copy number, or to use multiple guide RNAs that target multiple _W_-linked sequences [REF]. This way, multiple changes to the reference sequence would be required for a _W_ chromosome to acquire resistance to cleavage by the _W_-shredder. To ensure that the targets of cleavage do not become resistant as a result of indels that are induced by non-homologous end joining (NHEJ), one can ensure that the guide RNA's target lies within an essential gene where an indel would be fatal, preventing resistant alleles from accumulating in the population. This may not be necessary if the _W_-shredder targets many _W_-linked loci, but it is an important design consideration for any male component of the gene drive, because the evolution of _Z_-linked resistance completely nullifies the usefulness of male gene drive [echoing e.g. @unckless2017ev]. Recent work suggests that it is possible to create arrays which contain many guide RNAs separated by spacers [@kurata2018hi]; advances like this suggest that it may soon be less challenging to engineer gene drives that use multiple guide RNAs.

The model also indicated that extinction does not require the release of large numbers of individuals: releasing 20 _Z\*_Z\*_ males was often enough to eliminate a spatially-structured metapopulation of 10,000 individuals within a few generations. On the one hand, this is an advantageous property because _W_-shredders would be cheap and easy to deploy once they are developed, and they are likely to extirpate most or all of the metapopulation even if gene flow between subpopulations is weak. However, such high invasiveness is not always desirable, because it makes the gene drive more difficult to restrict to one particular site or population. This could limit the usefulness of _W_-shredders to control species like Lepidoptera and birds, where one may wish to eradicate only invasive or agriculturally damaging populations, while leaving other regions untouched. Modifications to gene drive design -- such as the self-limiting 'daisy drive' system -- are being developed to address this important concern [@min2017da; @noble2019da].

The model further showed that _W_-shredders can fail to cause extinction if carrier individuals have low fitness, although extinction was frequently oberved even when these fitness costs were substantial. Populations in which females can become highly fecund as the population shrinks (i.e. low $\alpha$ and high $r$) are also harder to drive extinct, though this could likely be solved by continually releasing more drive males. The model also highlighted that _W_-shredders, and indeed any gene drive that skews the sex ratio towards males, are most effective in suppressing species in which the density of males is an important determinant of population growth, e.g. because males use resources that females need [@li2019int]. By contrast if male density is not very important to population growth (e.g. because females are limited by a resource that is not consumed by males), female fecundity increases as females become rarer, slowing the decline in population size caused by the _W_-shredder and potentially staving off extinction. Interestingly, the sexes are very different in the trematode parasites (_Schistosoma_ sp.) which cause schistosomiasis, which have been proposed as candidates for control using a _W_-shredders. Female _Schistosoma_ live inside the body of the much larger male, who feeds on the host's blood and passes some of it to the female. Presumably, this means that the number of males (not females) is the primary determinant of whether a host/population is full to capacity, making _Schistosoma_ a good candidate for control with _W_-shredders. In Lepidoptera and birds -- two other _ZW_ taxa that could potentially be controlled with _W_-shredders -- males and females generally do have similar ecological niches, such that _W_-shredders should be effective. Other ecological parameters like the patchiness of the population ($k$), the frequency and sex bias of dispersal ($x_f$ and $x_m$), and the scale of competition ($\psi$) had relatively little effect on the probability of extinction.

Finally, I note that _W_-shredders might tend to be easier to develop than _X_-shredders. Intital efforts to develop an _X_-shredder in _Anopheles_ mosquitos were hindered because the protein that targets the _X_ was paternally transmitted to the embryo inside both _X_- and _Y_-bearing sperm, causing all embryos to die due to cleavage of the maternally-inherited _X_, resulting in the loss of the drive allele in a single generation. Although this technical issue was later solved using ingenuity, such paternal effects would not be a problem for a _W_-shredder since the _W_ chromosome is unique to females. Additionally, _W_-shredders might sometimes be easier to develop than gene drives that work by deleting genes that are essential to female (but not male) fertility or viability [e.g. @burt2018se]. This is because one could design a prototype _W_-shredder using only sequence data from the sex chromosomes, while identifying genes with female-specific fitness effects requires more detailed data (e.g. expression profiling or knockout studies) that is not always readily available.


# Acknowledgements
I thank the organisers (Anna Lindholm and Tom Price), funding bodies (European Society for Evolutionary Biology; Swiss National Science Foundation), and attendees of the 2018 ESEB _Progress Meetings in Evolutionary Biology_, which provided the impetus for this paper. I also thank Kevin Esvelt and colleagues for describing their ongoing research on a personal webpage; their ideas greatly influenced this paper.

# References
<div id="refs"></div>

\newpage
# Tables

**Table 1**: List of variables, and their corresponding parameter(s) in the model, which were varied in order to study their effects on the likelihood of population extinction.
```{r xtable, results="asis", fig.cap="Zfgzf"}
print_table1()
```


\newpage
# Figures

<!-- \begin{figure} -->
<!-- \centering -->
<!-- \includegraphics{../figures/figure1.pdf} -->
<!-- \caption{\footnotesize{Three illustrative runs of the simulation, showing evolution in response to the introduction of 20 males carrying a \textit{W}-shredder at Generation 50 (marked by dotted line). In panel A, the driving $Z^*$ allele fixed very quickly, causing population extinction through a shortage of females. In panel B, the $Z^*$ allele spread until its fitness costs began to negate its transmission advantage, causing the population to persist at a reduced size. In panel C, the $Z^*$ allele invaded, which selected for the resistance alleles \textit{A} and $Z^r$ and caused $Z^*$ to go extinct. The population size \textit{N} is shown as a fraction of its maximum value of 10,000. Table S3 gives the parameter spaces used for these three runs.}} -->
<!-- \end{figure} -->
<!-- \newpage -->


\begin{figure}
\centering
\includegraphics{../figures/figure2.pdf}
\caption{\footnotesize{The percentage of simulations of a \textit{W}-shredder that ended in extinction, for all runs with a particular value (shown on the \textit{x}-axis) for a given parameter (shown in the panels). For example, there were no extinctions in any of the thousands of runs for which I assumed $p_{shred} = 0.5$, while 60\% of runs where $p_{shred} = 1$ resulted in extinction. The panels are ordered by the range of the \textit{x}-axis, which indicates the relative importance of the variables for the probability of extinction. Figure S1 gives a similar plot for simulations of a female-sterilising $Z^*$ allele.}}
\end{figure}
\newpage

\begin{figure}
\centering
\includegraphics{../figures/figure3.pdf}
\caption{\footnotesize{Heatmap showing the nine strongest interactions between pairs of parameters in the model, as determined by the GLM plotted in Figure SX.}}
\end{figure}


