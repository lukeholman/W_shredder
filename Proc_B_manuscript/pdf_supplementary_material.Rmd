---
title: "Supplementary Information"
output: pdf_document
header-includes: 
  \usepackage{booktabs}
  \usepackage{microtype}
  \usepackage{longtable}
  \usepackage[margin=1in]{geometry}
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(kableExtra)
library(stringr)

make_table <- function(file, LT = TRUE, digits = getOption("digits")){
  kable(readRDS(file), "latex", longtable = LT, booktabs = TRUE, digits = digits) %>%
    kable_styling(latex_options = c("repeat_header", "scale_down"), font_size = 7)
}
```


## Evolutionary simulations of _Z_-linked suppression gene drives

## Supplementary Figures and Supplementary Tables

All of the figures and tables in this document can also be viewed online at [https://lukeholman.github.io/W_shredder/](), along with the R code used to generate them.

\newpage
# Supplementary tables

```{r echo=FALSE}
count_S1 <- sum(readRDS("../figures/tableS1.rds")[,2])
count_S2 <- sum(readRDS("../figures/tableS2.rds")[,2])
```


**Table S1**: The number and percentage of simulation runs (out of `r prettyNum(count_S1, big.mark = ",", scientific = FALSE)` total) that ended with the five possible outcomes, for the subset of simulation runs focusing on a _W_-shredder gene drive.
```{r, results='asis'}
make_table("../figures/tableS1.rds")
```

\vspace{0.5in}
**Table S2**: The number and percentage of simulation runs (out of `r prettyNum(count_S2, big.mark = ",", scientific = FALSE)` total) that ended with the five possible outcomes, for the subset of simulation runs focusing on a female-sterilising _Z_-linked gene drive.
```{r, results='asis'}
make_table("../figures/tableS2.rds")
```



\newpage
# Supplementary figures

```{r fig.width = 12, fig.height = 14}
readRDS("../figures/S1_fig.rds")
```
**Figure S1**: Similar plot to Figure 3, except that the \textit{y}-axis shows the median number of generations until the \textit{W}-shredder caused extinction, among just the subset of simulations in which extinction actually occurred. A median was only calculated if at least 40 simulation runs reached extinction.
\newpage

```{r fig.width = 15, fig.height = 15}
readRDS("../figures/S2_fig.rds")
```
**Figure S2**: Heatmap showing the twelve strongest interactions between pairs of parameters in the model, as determined by the effect sizes from the GLM plotted in Figure 4. 
\newpage

```{r fig.width = 10, fig.height = 10.6}
readRDS("../figures/S3_fig.rds")
```
**Figure S3**: Analagous information to Figure 3, but showing the results for a female-sterilising $Z^*$ allele instead of a \textit{W}-shredder.
\newpage

```{r fig.height = 12, fig.width = 10}
readRDS("../figures/S4_fig.rds")
```
**Figure S4**: Analagous information to Figure S1, but showing the results for a female-sterilising $Z^*$ allele instead of a \textit{W}-shredder. Note that a median was only calculated if at least 40 simulation runs reached extinction, and extinction only occurred when gene drive in males was strong.
\newpage

```{r fig.height = 8, fig.width = 8}
readRDS("../figures/S5_fig.rds")
```
**Figure S5**: Relative parameter importance in the simulations of _Z_-linked female-sterilising gene drives, for the top 25 most important main effects or two-way interactions (from a binomial GLM that included all the main effects and all their two-way interactions). Each predictor variable was scaled before running the model, meaning that the absolute effect size indicates how important each parameter is to the extinction probability, given the range of values plotted in Figure S3.
\newpage

```{r fig.width = 15, fig.height = 15}
readRDS("../figures/S6_fig.rds")
```
**Figure S6**: Heatmap illustrating the twelve strongest two-way interactions for simulations of a female-sterilising gene drive, as determined by the effect sizes from the GLM plotted in Figure S5. 



